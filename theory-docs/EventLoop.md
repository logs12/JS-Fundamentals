#  Event loop javascript #

Heap (куча) — объекты собраны в кучу, которая есть ни что иное, как название для наименее структурированной части памяти.
---
Stack (стопка, стек) — репрезентация единственного потока выполнения JavaScript-кода. Вызовы функций помещаются в стек (об этом ниже).
---
Browser or Web API’s (браузерные или веб API) — встроены в браузер и способны предоставлять данные из браузера и окружающей компьютерной среды и давать возможность выполнять с ними полезные и сложные вещи. Они не являются частью языка JavaScript, но они построены на его основе и предоставляют вам супер силы, которые можно использовать в JavaScript коде. Например Geolocation API предоставляет доступ к нескольким простым конструкциям JavaScript, которые используются для получения данных о местоположении, так что вы можете, скажем, отобразить своё местоположение на Google Map. В фоновом режиме браузер использует низкоуровневый код (например C++) для связи с оборудованием GPS устройства (или любым другим, доступным для определения данных о местоположении), получения данных о местоположении и возвращения их в среду браузера для использования в вашем коде. Но опять, эта сложность абстрагирована от вас посредством API.

`

function main() {
console.log('A')
setTimeout(function exec() {
  console.log('B')
}, 0)
console.log('C')
}
main() 
// Output
// A
// C
// B

`

1. Вызов функции main сначала поместит её в стек (в качестве первого элемента (frame)). 
Потом браузер поместит в стек первое выражение функции main, которое представляет собой console.log(‘A’). Это выражение выполняется и, после завершения, удаляется из стека. Буква A выводится в консоль.
2. Следующее выражение (setTimeout() с коллбэком exec() и временем ожидания в 0 секунд) помещается в стек вызовов и выполнение начинается. Функция setTimeout использует API браузера для задержки вызова предоставленной функции. Элемент (frame) удаляется из стека сразу после завершения передачи таймера браузерному API.
3. console.log(‘C’) помещается в стек, пока в браузере запускается таймер для вызова функции exec(). В этом конкретном случае, поскольку время ожидания составляет 0 секунд, коллбэк (функция exec()) будет помещён в message queue (очередь сообщений), сразу после того как браузер его получит (в идеале).
4. После выполнения последнего выражения функции main, элемент main удаляется из стека вызовов (call stack), оставляя его пустым. **Стек вызовов должен быть пустым, для того чтобы браузер поместил в него элемент из message queue. Именно по этой причине даже если в setTimeout указано время ожидания в 0 секунд, функция exec() не выполняется, пока не закончится выполнение всех элементов в стеке вызовов**.
5. Теперь функция exec() помещается в стек вызовов и выполняется. Буква C выводится в консоль. Вот он — цикл событий (EventLoop) JavaScript.